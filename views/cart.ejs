<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="../stylesheets/style.css" />
    <title>Cart</title>
  </head>
  <body>
    <div class="min-h-screen">
      <nav class="flex justify-between items-center px-20 py-7">
        <h1 class="text-3xl font-bold text-blue-700">Shop.</h1>
        <div class="flex justify-center gap-15 font-semibold">
          <ul class="flex gap-3 cursor-pointer">
            <li class="p-2"><a href="">Home</a></li>
            <li class="p-2"><a href="">Products</a></li>
          </ul>
          <ul class="flex gap-3 cursor-pointer">
            <li class="p-2"><a href="/chart">Cart</a></li>
            <li class="p-2"><a href="">My account</a></li>
          </ul>
          <ul>
            <li class="p-2 text-red-600"><a href="/users/logout">Logout</a></li>
          </ul>
        </div>
      </nav>

      <div class="h-[2px] bg-zinc-500"></div>

      <div class="flex flex-col gap-8 my-8 px-8">
        <% if (user && user.cart && user.cart.length > 0) { %> <%
        user.cart.forEach(item => { %> <% 
          const itemBill = (item.price + 200) -item.discount;
          %>
        <div class="flex justify-center gap-8">
          <div class="w-80">
            <div
              class="h-72 flex items-center justify-center overflow-hidden"
              style="background-color: <%= item.bgcolor %>"
            >
              <img
                src="data:image/jpeg;base64,<%= item.image.toString('base64') %>"
                alt="Cart Item"
                class="object-cover h-full w-full"
              />
            </div>

            <div class="p-3" style="background-color: <%= item.panelcolor %>">
              <h2 class="font-semibold"><%= item.name%></h2>
            </div>

            <div class="bg-gray-300 flex justify-between p-3 rounded-bt">
              <div>
                <h3>Net Total</h3>
              </div>
              <div>
                <h3 class="font-semibold">Rs. <%= itemBill %></h3>
              </div>
            </div>
          </div>
          <div class="min-w-[40vw] bg-white rounded-lg shadow p-5">
            <div class="p-3">
              <h1 class="font-semibold text-lg">Price Breakdown</h1>
            </div>

            <div class="p-5">
              <div class="flex justify-between gap-6 px-4 py-2">
                <h4>Total MRP</h4>
                <p>Rs. <%= item.price %></p>
              </div>

              <div class="flex justify-between gap-6 px-4 py-2">
                <h4>Discount on MRP</h4>
                <p>Rs. <%= item.discount %></p>
              </div>

              <div class="flex justify-between gap-6 px-4 py-2">
                <h4>Platform Fee</h4>
                <p>Rs. 200</p>
              </div>

              <div class="flex justify-between gap-6 px-4 py-2">
                <h4>Shipping Fee</h4>
                <p>FREE</p>
              </div>
            </div>

            <div class="h-[2px] bg-zinc-200 my-2"></div>

            <div class="flex justify-between p-5 text-xl">
              <h2 class="font-semibold">Total Amount</h2>
              <h2 class="text-green-500 font-semibold">Rs. <%= itemBill %></h2>
            </div>
          </div>
        </div>
        <% }) %> <% } else { %>
        <p class="text-center py-10">No items in your cart.</p>
        <% } %>
      </div>
    </div>
  </body>
</html>
